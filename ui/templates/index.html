<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Honeypot Session Review</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- Highlight.js for YAML syntax highlighting -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
</head>
<body>
<div class="page">
    <header class="header">
        <div class="header-left">
            <h1>Honeypot Session Review</h1>
            <p>ETL → AI Layer 1 → RAG-enriched sessions</p>
        </div>

        <div class="header-right">
            <label for="date-input">Date:</label>
            <input type="date" id="date-input" value="{{ default_date }}">
            <button id="reload-btn">Load</button>
        </div>
    </header>

    <main class="main">

        <!-- LEFT SIDE -->
        <section class="sessions-panel">
            <div class="sessions-panel-header">
                <h2>Sessions</h2>

                <div class="sensor-filter">
                    <label for="sensor-filter">Filter:</label>
                    <select id="sensor-filter">
                        <option value="all">All</option>
                        <option value="Cowrie">Cowrie</option>
                        <option value="Dionaea">Dionaea</option>
                        <option value="Wordpot">Wordpot</option>
                        <option value="Suricata">Suricata</option>
                    </select>
                </div>
            </div>

            <div id="sessions-list" class="sessions-list">
                <!-- Filled by JS -->
            </div>
        </section>

        <!-- RIGHT SIDE -->
        <section class="detail-panel">
            <h2>Session detail</h2>
            <div id="session-detail" class="session-detail">
                <p>Select a session to view details.</p>
            </div>
        </section>

    </main>
</div>

<!-- SIGMA MODAL -->
<div id="sigma-modal" class="modal hidden">
    <div class="modal-backdrop" id="sigma-modal-backdrop"></div>
    <div class="modal-content">
        <button class="modal-close" id="sigma-modal-close">×</button>
        <h3 id="sigma-modal-title">Sigma rule</h3>

        <button id="sigma-copy-btn" class="copy-btn">Copy to clipboard</button>

        <!-- Syntax-highlight container -->
        <pre><code id="sigma-modal-body" class="language-yaml"></code></pre>
    </div>
</div>

<!-- Highlight.js scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
<script>hljs.highlightAll();</script>

<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
